{"version":3,"sources":["../../src/interfaces/events/event-dispatcher.interface.ts","../../src/channels/stack-channel.ts"],"names":["IEventDispatcher","StackChannel","injectable","inject"],"mappings":"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","file":"stack-channel.js","sourcesContent":["import type { ILogEvent } from './log-event.interface'\nimport type { LogListener } from '../../types/types'\n\n/**\n * IEventDispatcher defines the contract for event dispatchers.\n * It provides methods for dispatching events and managing event listeners.\n */\nexport interface IEventDispatcher {\n  /**\n   * Dispatch an event\n   * @param event The event to dispatch\n   */\n  dispatch(event: ILogEvent): void\n\n  /**\n   * Add a listener for an event\n   * @param eventName The event name\n   * @param listener The event listener\n   */\n  addListener(eventName: string, listener: LogListener): void\n\n  /**\n   * Remove a listener for an event\n   * @param eventName The event name\n   * @param listener The event listener\n   */\n  removeListener(eventName: string, listener: LogListener): void\n\n  /**\n   * Get all listeners for an event\n   * @param eventName The event name\n   */\n  getListeners(eventName: string): LogListener[]\n\n  /**\n   * Check if an event has listeners\n   * @param eventName The event name\n   */\n  hasListeners(eventName: string): boolean\n\n  /**\n   * Remove all listeners for an event\n   * @param eventName The event name\n   */\n  clearListeners(eventName: string): void\n}\n\n/**\n * Namespace containing symbols for dependency injection\n */\nexport namespace IEventDispatcher {\n  /**\n   * Symbol for injecting the event dispatcher\n   */\n  export const $ = Symbol.for('IEventDispatcher')\n}\n","import { injectable, inject } from 'inversify'\nimport type { LogLevel } from '../enums/log-level.enum'\nimport type { IStackChannel } from '../interfaces/channels/stack-channel.interface'\nimport type { ILoggingChannel } from '../interfaces/channels/logging-channel.interface'\nimport { IEventDispatcher } from '../interfaces/events/event-dispatcher.interface'\nimport type { LogContext, LogRecord } from '../types/types'\n\n/**\n * StackChannel is an implementation of the IStackChannel interface.\n * It combines multiple channels into a single channel.\n */\n@injectable()\nexport class StackChannel implements IStackChannel {\n  private name: string\n  private context: LogContext = {}\n  private channels: ILoggingChannel[] = []\n\n  /**\n   * Create a new StackChannel instance\n   * @param name The channel name\n   * @param eventDispatcher The event dispatcher to use\n   */\n  constructor(name: string, @inject(IEventDispatcher.$) eventDispatcher: IEventDispatcher) {\n    this.name = name\n  }\n\n  /**\n   * Log a message at the specified level\n   * @param level The log level\n   * @param message The message to log\n   * @param context Optional contextual data\n   */\n  public log(level: LogLevel, message: string, context: LogContext = {}): void {\n    // Merge the context with the channel's context\n    const mergedContext = { ...this.context, ...context }\n\n    // Log the message to all channels in the stack\n    for (const channel of this.channels) {\n      channel.log(level, message, mergedContext)\n    }\n  }\n\n  /**\n   * Add contextual data to all subsequent log messages\n   * @param context The contextual data to add\n   */\n  public withContext(context: LogContext): ILoggingChannel {\n    this.context = { ...this.context, ...context }\n    return this\n  }\n\n  /**\n   * Remove contextual data from all subsequent log messages\n   * @param keys The keys to remove from the context\n   */\n  public withoutContext(keys: string[]): ILoggingChannel {\n    const newContext: LogContext = { ...this.context }\n    for (const key of keys) {\n      delete newContext[key]\n    }\n    this.context = newContext\n    return this\n  }\n\n  /**\n   * Get the channel name\n   */\n  public getName(): string {\n    return this.name\n  }\n\n  /**\n   * Process a log record\n   * @param record The log record to process\n   */\n  public processRecord(record: LogRecord): LogRecord {\n    // Process the record with all channels in the stack\n    let processedRecord = record\n    for (const channel of this.channels) {\n      processedRecord = channel.processRecord(processedRecord)\n    }\n    return processedRecord\n  }\n\n  /**\n   * Share context across channels\n   * @param context The contextual data to share\n   */\n  public shareContext(context: LogContext): void {\n    for (const channel of this.channels) {\n      channel.shareContext(context)\n    }\n  }\n\n  /**\n   * Flush shared context\n   */\n  public flushSharedContext(): void {\n    for (const channel of this.channels) {\n      channel.flushSharedContext()\n    }\n  }\n\n  /**\n   * Get the channels in the stack\n   */\n  public getChannels(): ILoggingChannel[] {\n    return this.channels\n  }\n\n  /**\n   * Add a channel to the stack\n   * @param channel The channel to add\n   */\n  public addChannel(channel: ILoggingChannel): void {\n    this.channels.push(channel)\n  }\n\n  /**\n   * Remove a channel from the stack\n   * @param name The name of the channel to remove\n   */\n  public removeChannel(name: string): void {\n    this.channels = this.channels.filter((channel) => channel.getName() !== name)\n  }\n\n  /**\n   * Check if the stack contains a channel with the specified name\n   * @param name The channel name\n   */\n  public hasChannel(name: string): boolean {\n    return this.channels.some((channel) => channel.getName() === name)\n  }\n\n  /**\n   * Get the channel with the specified name\n   * @param name The channel name\n   */\n  public getChannel(name: string): ILoggingChannel | undefined {\n    return this.channels.find((channel) => channel.getName() === name)\n  }\n}\n"]}